//
//  MyCourseView.swift
//  云课堂2
//
//  Created by 尤增强 on 2018/7/3.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import SwiftyJSON

@objc protocol MyCourseViewDategate{

    @objc optional func actionCourseMore(type:Int) -> ()
    @objc optional func returnCourseId(Id:String,type:Int,courseTitle:String) -> ()

}


class MyCourseView: UIView {

    var MyCourseViewDategate:MyCourseViewDategate!

    @IBOutlet weak var lab_type: UILabel!
    @IBOutlet weak var view1: UIView!
    @IBOutlet weak var lab_more: UILabel!
    @IBOutlet weak var line: UILabel!
  
    @IBOutlet weak var view4: UIView!
    @IBOutlet weak var view3: UIView!
    @IBOutlet weak var view2: UIView!
    @IBOutlet weak var img1: UIImageView!
    @IBOutlet weak var lab_title1: UILabel!
    @IBOutlet weak var lab_school1: UILabel!

    @IBOutlet weak var img2: UIImageView!
    
    @IBOutlet weak var lab_title2: UILabel!
    
    @IBOutlet weak var lab_school2: UILabel!
    
    @IBOutlet weak var img3: UIImageView!
    @IBOutlet weak var lab_school3: UILabel!
    @IBOutlet weak var lab_title3: UILabel!

    @IBOutlet weak var img4: UIImageView!
    
    @IBOutlet weak var lab_school4: UILabel!
    @IBOutlet weak var lab_title4: UILabel!
    var list = [JSON]()
    var type = 0
    override init(frame: CGRect) {
        super.init(frame: frame)
        awakeFromNib()
    }

    required init?(coder aDecoder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }

    override func awakeFromNib() {
        print(1212)
        super.awakeFromNib()
        self.backgroundColor = UIColor.clear
        let subView : UIView = Bundle.main.loadNibNamed("MyCourseView", owner: self, options: nil)?.first as! UIView
        subView.frame = self.frame
        self.addSubview(subView)
        let ges = UITapGestureRecognizer.init(target: self, action: #selector(self.actionMore))
        self.lab_more.isUserInteractionEnabled = true
        self.lab_more.addGestureRecognizer(ges)


         let gesImg1 = UITapGestureRecognizer(target: self, action: #selector(returnIdAndType))
         let gesImg2 = UITapGestureRecognizer(target: self, action: #selector(returnIdAndType))
         let gesImg3 = UITapGestureRecognizer(target: self, action: #selector(returnIdAndType))
         let gesImg4 = UITapGestureRecognizer(target: self, action: #selector(returnIdAndType))
        self.img1.tag = 0
        self.img2.tag = 1
        self.img3.tag = 2
        self.img4.tag = 3
        self.img1.isUserInteractionEnabled = true
        self.img1.addGestureRecognizer(gesImg1)
        self.img2.isUserInteractionEnabled = true
        self.img2.addGestureRecognizer(gesImg2)
        self.img3.isUserInteractionEnabled = true
        self.img3.addGestureRecognizer(gesImg4)
        self.img4.isUserInteractionEnabled = true
        self.img4.addGestureRecognizer(gesImg3)


    }

    @objc func actionMore(){

        self.MyCourseViewDategate?.actionCourseMore!(type: type)
    }
    @objc func returnIdAndType(_ gestureRecognizer: UITapGestureRecognizer){

        let index = gestureRecognizer.view?.tag

        self.MyCourseViewDategate?.returnCourseId!(Id: self.list[index!]["Id"].stringValue, type: type, courseTitle: self.list[index!]["Title"].stringValue)
    }
    func setCourseData(d:JSON){
        self.list = d.arrayValue
        self.lab_title1.text = d[0]["Title"].stringValue
        self.lab_school1.text = d[0]["UnitName"].stringValue
        common.share.setSDImg(str: d[0]["Cover"].stringValue, imgview: self.img1)

        self.lab_title2.text = d[1]["Title"].stringValue
        self.lab_school2.text = d[1]["UnitName"].stringValue
        common.share.setSDImg(str: d[1]["Cover"].stringValue, imgview: self.img2)

        self.lab_title3.text = d[2]["Title"].stringValue
        self.lab_school3.text = d[2]["UnitName"].stringValue
        common.share.setSDImg(str: d[2]["Cover"].stringValue, imgview: self.img3)

        self.lab_title4.text = d[3]["Title"].stringValue
        self.lab_school4.text = d[3]["UnitName"].stringValue
        common.share.setSDImg(str: d[3]["Cover"].stringValue, imgview: self.img4)
        
    }


    func setSmallCourseData(d:JSON){
        self.list = d.arrayValue
        self.lab_type.text = "微课"
        self.type = 1
        self.lab_title1.text = d[0]["Title"].stringValue
        self.lab_school1.text = d[0]["UnitName"].stringValue
        common.share.setSDImg(str: d[0]["Cover"].stringValue, imgview: self.img1)

        self.lab_title2.text = d[1]["Title"].stringValue
        self.lab_school2.text = d[1]["UnitName"].stringValue
        common.share.setSDImg(str: d[1]["Cover"].stringValue, imgview: self.img2)

        self.lab_title3.text = d[2]["Title"].stringValue
        self.lab_school3.text = d[2]["UnitName"].stringValue
        common.share.setSDImg(str: d[2]["Cover"].stringValue, imgview: self.img3)

        self.lab_title4.text = d[3]["Title"].stringValue
        self.lab_school4.text = d[3]["UnitName"].stringValue
        common.share.setSDImg(str: d[3]["Cover"].stringValue, imgview: self.img4)

    }

    override func layoutSubviews() {
        self.line.backgroundColor = UIColor.bg
        
    }
}
