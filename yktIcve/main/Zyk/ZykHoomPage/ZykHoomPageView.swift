//
//  ZykHoomPageView.swift
//  云课堂2
//
//  Created by 志辉教育 on 2018/7/2.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit

class ZykHoomPageView: UIViewController,UIScrollViewDelegate{
    init() {
        super.init(nibName: "ZykHoomPageView", bundle: nil)
    }
    //隐藏状态栏
    override var prefersStatusBarHidden: Bool {
        return true
    }
    required init?(coder aDecoder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }
    override func viewDidLoad() {
        super.viewDidLoad()
        self.setUI()
        self.getIndex()
        self.title = "资源库"
        let item = UIBarButtonItem(title: "返回", style: .plain, target: self, action: nil)
        self.navigationItem.backBarButtonItem = item
        self.ImgScrollView.delegate = self
        self.Imgshuffling()
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }
    func setUI(){
        let myView = MyCourseAndSmallClassView()
        myView.Delegate = self
        self.myActionView.addSubview(myView)
        myView.snp.makeConstraints { (make) in
            make.bottom.top.left.right.width.equalTo(self.myActionView)
        }

        myProfessionalView.MyProfessionalDetegate = self
        self.professionalView.addSubview(myProfessionalView)
        self.myProfessionalView.snp.makeConstraints { (make) in
            make.bottom.top.left.right.width.equalTo(self.professionalView)
        }
        self.myProfessionalView.frame =   self.professionalView.frame

       

    }
    //页面离开关闭定时器 开启导航栏
    override func viewWillDisappear(_ animated: Bool) {
        super.viewWillDisappear(false)
        self.timer?.invalidate()
        self.timer = nil
        self.navigationController?.setNavigationBarHidden(false, animated:false)
    }
    
    override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(false)
        if #available(iOS 11.0, *) {
        self.scrollview.contentInsetAdjustmentBehavior = .never
        } else {
            automaticallyAdjustsScrollViewInsets = false;
        };
        self.scrollview.contentInset = UIEdgeInsetsMake(0, 0, 0, 0)
        self.scrollview.scrollIndicatorInsets =  self.scrollview.contentInset
        self.navigationController?.setNavigationBarHidden(true, animated: false)
    }
    override func viewDidLayoutSubviews() {
//       if(UIDevice.current.model == "iPad"){
//          self.contentH.constant = 766
//       }else{
          self.contentH.constant = 506
//       }
    }
    
    lazy var PageControl :UIPageControl = {
        let con = UIPageControl()
        return con
    }()
    var timer:Timer? = nil
    var Imgpage:Int = 0
   
    @IBOutlet var contentView: UIView!
    let myProfessionalView = MyProfessionalView()
    let CourseView = MyCourseView()
    let SmallCourseView = MyCourseView()
    @IBOutlet weak var professionalView: UIView!
  
    @IBOutlet var ImgScrollView: UIScrollView!
    @IBOutlet weak var myActionView: UIView!
    @IBOutlet weak var myCourseView: UIView!
    @IBOutlet weak var contentH: NSLayoutConstraint!
    @IBOutlet weak var scrollview: UIScrollView!
    @IBOutlet weak var mySmallCourse: UIView!
    /*
    // MARK: - Navigation

    // In a storyboard-based application, you will often want to do a little preparation before navigation
    override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
        // Get the new view controller using segue.destinationViewController.
        // Pass the selected object to the new view controller.
    }
    */

}

extension ZykHoomPageView :MyCourseAndSmallClassViewDelegate,MyProfessionalViewDategate,MyCourseViewDategate{

    func action_myCourse(type: Int) {
        let vc  = ZykMineCourseView()
        vc.type = type
        vc.hidesBottomBarWhenPushed = true
        self.navigationController?.pushViewController(vc, animated: true)
    }

    //微课 课程 全部
    func actionCourseMore(type: Int) {
        print(type)
        let vc = ZykAllCourseView()
        vc.hidesBottomBarWhenPushed = true
        vc.type = type + 1
        if type == 0{
            vc.title = "全部课程"
        }else{
            vc.title = "全部微课"
        }
        self.navigationController?.pushViewController(vc, animated: true)
    }
//    返回课程id
    func returnCourseId(Id: String, type: Int,courseTitle:String) {
        print(Id)
        let vc = ZykcourseDetailsView()
        vc.courseTitle = courseTitle
        vc.DetailsType = 1
        vc.type = type + 1
        vc.courseId = Id
        vc.hidesBottomBarWhenPushed = true
        self.navigationController?.pushViewController(vc, animated: true)
    }
    //项目全部
    func actionMore() {
        let vc = ZykAllProfessionView()
        vc.hidesBottomBarWhenPushed = true
        self.navigationController?.pushViewController(vc, animated: true)
    }
//    项目id
    func returnId(Id: String,professionTitle:String) {
        print(Id)
        let vc = ZykProfessionDetailsView()
        vc.Id = Id
        vc.ProjectName = professionTitle
        vc.hidesBottomBarWhenPushed = true
        self.navigationController?.pushViewController(vc, animated: true)
    }
}
