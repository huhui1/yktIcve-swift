//
//  zjy_courseware_BBS_detailsViewController.swift
//  云课堂2
//
//  Created by 尤增强 on 2018/7/4.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import SwiftyJSON
import Alamofire

extension zjy_courseware_BBS_detailsView{


    //获取当前主题下回复
    func getCellBBSReplyList(){
        if(self.evaluation == nil){
            return
        }
        let dict = ["Id": self.evaluation.Id]

        XLBallLoading.show(in: self.view)
        Alamofire.request(appAPI.BBS_getCellBBSReplyList, method: .post, parameters: dict, encoding: URLEncoding.default).responseJSON { response in
            if let value = response.result.value {
                let json = JSON(value)
                if json["code"] == 1{
                    self.setDataForUI(r: json["replyList"])
                }else{
                    ZKProgressHUD.showError(json["msg"].stringValue);
                }
                XLBallLoading.hide(in: self.view)
            }else{
                ZKProgressHUD.showError("网络环境异常请稍后再试！");
                XLBallLoading.hide(in: self.view)
            }
        }

    }

    func setDataForUI(r:JSON){
        for i in r {
           let m = BBSReplyModel.init(i: i.1)
            self.list.append(m)
        }
        self.tableview.tableHeaderView = self.headview
        self.tableview.reloadData()
        common.share.setTableFootView_noData(self.tableview, list: self.list as NSArray)
    }

}

