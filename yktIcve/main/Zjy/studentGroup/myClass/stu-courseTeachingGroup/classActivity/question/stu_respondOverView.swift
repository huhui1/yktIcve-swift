//
//  stu_respondOverView.swift
//  云课堂职教云
//
//  Created by cc on 2018/5/16.
//  Copyright © 2018年 jcjy. All rights reserved.
//

import UIKit
import SwiftyJSON

class stu_respondOverView: UIViewController,UITableViewDelegate,UITableViewDataSource{

    override func viewDidLoad() {
        super.viewDidLoad()
        self.view.backgroundColor = UIColor.colorWithHex(hexColor: 0xf2f2f2)
        self.setUI()
        self.setTableviewUI()
        self.title = "提问"
        self.refreshItemData(isRefresh: true);
        
        // Do any additional setup after loading the view.
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }
    func setTableviewUI(){
        //创建表视图
        self.tableView = UITableView.init(frame: CGRect(x:0, y:220, width:width, height:height - 285));
        
        self.tableView.delegate = self;
        self.tableView.dataSource = self;
        
        self.tableView.register(batchScorseTableCell.self, forCellReuseIdentifier: "batchScorseCell")
        
        tableView.tableFooterView = UIView(frame:CGRect.zero)//除去多余的cell
        tableView.separatorInset = UIEdgeInsets.zero;
        tableView.layoutMargins = UIEdgeInsets.zero;
        
        if #available(iOS 9.0, *) {
            tableView.cellLayoutMarginsFollowReadableWidth = false
        } else {
            // Fallback on earlier versions
        }
        //下拉刷新相关设置,使用闭包Block
        self.tableView.mj_header = MJRefreshNormalHeader(refreshingBlock: {
            //重现生成数据
            self.refreshItemData(isRefresh:false); 
            
        })
        self.view.addSubview(self.tableView);
    }
    
    func setUI(){
        self.view.addSubview(self.questitle)
        self.view.addSubview(self.center)
        self.questitle.snp.makeConstraints { (make) in
            make.width.equalTo(UIScreen.main.bounds.width)
            make.height.equalTo(50)
            make.top.equalTo(10)
        }
        self.center.snp.makeConstraints { (make) in
            make.width.equalTo(UIScreen.main.bounds.width)
            make.height.equalTo(130)
            make.top.equalTo(self.questitle.snp.bottom).offset(10)
        }
    }
    
    func numberOfSections(in tableView: UITableView) -> Int {
        // #warning Incomplete implementation, return the number of sections
        return 1
    }
    
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -> CGFloat
    {
        return 50;
    }
    
    //返回表格行数（也就是返回控件数）
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        
        return self.list.count;
    }
    
    //创建各单元显示内容(创建参数indexPath指定的单元）
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath)
        -> UITableViewCell {
            
            let cell:batchScorseTableCell = tableView.dequeueReusableCell(withIdentifier: "batchScorseCell", for: indexPath) as! batchScorseTableCell
            cell.imgView_avatar.snp.makeConstraints { (make) in
                make.width.height.equalTo(40)
                make.left.equalTo(10)
                make.centerY.equalTo(cell.snp.centerY)
            }
            let data = JSON(self.list[indexPath.row])
            cell.lab_Name.text = "\(data["Name"].stringValue)"
            cell.lab_num.text = "\(data["StuNo"].stringValue)"
            cell.lab_socre.tag = indexPath.row
            if(data["IsScore"].intValue == 0){
                cell.lab_socre.text = "\u{e67c}"
            }else{
                cell.lab_socre.text = "\u{e67c}\(data["PerformanceScore"].intValue)"
                cell.lab_socre.textColor = UIColor.bg
            }
            common.share.setSDImg(str:data["Avator"].stringValue, imgview: cell.imgView_avatar)
            cell.lab_socre.isUserInteractionEnabled = true;
            
            
            return cell
    }

    lazy var questitle : UITextView = {
        let text = UITextView()
        text.font = UIFont.italicSystemFont(ofSize: 15)
        text.textColor = UIColor.black
        text.backgroundColor = UIColor.white
        text.isEditable = false
        return text
    }()
    lazy var center : UITextView = {
       let text = UITextView()
        text.font = UIFont.italicSystemFont(ofSize: 13)
        text.textColor = UIColor.black
        text.backgroundColor = UIColor.white
        text.isEditable = false
        return text
    }()
    let width = UIScreen.main.bounds.width
    let height = UIScreen.main.bounds.height
    lazy var activityId:String  = {return ""}()
    lazy var courseOpenId :String = {return ""}()
    lazy var quizId :String = {return ""}()
    lazy var openClassIds :String = {return ""}()
    lazy var askType :Int = {return 1}()
    lazy var list:NSArray = []
    lazy var state :Int = {
        return 0
    }()
    lazy var tableView :UITableView = {
        let table = UITableView()
        return table
    }()
}
