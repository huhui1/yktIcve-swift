//
//  stuPreviewTestController.swift
//  云课堂职教云
//
//  Created by 尤增强 on 2018/3/26.
//  Copyright © 2018年 jcjy. All rights reserved.
//

import UIKit
import SwiftyJSON
import Alamofire

extension stuPreviewTestView {

    func getClassTestData(){
        let dict = ["activityId":self.activityId,
                    "classTestId":self.examId]
        Alamofire.request(appAPI.FaceTeach_getClassTestData, method: .post, parameters: dict, encoding: URLEncoding.default).responseJSON { response in
            if let value = response.result.value {
                let json = JSON(value)
                if(json["code"]>0){
                    self.theWebView.evaluateJavaScript("report.get(\(json))",
                        completionHandler: nil)
                }else{
                    ZKProgressHUD.showError(json["msg"].stringValue);
                }

            }else{
                ZKProgressHUD.showError("网络环境异常请稍后再试！");
            }
        }

    }


    func errorTitleParsing(data:String){
        let errorQuestionList = JSON.init(parseJSON: data)
        if(errorQuestionList.count==0){
            ZKProgressHUD.showMessage("暂无错题分析")
            return
        }else{
            let vc = examReportRecordView()
            vc.errorQuestionList = data
             self.isPused = true
            self.navigationController?.pushViewController(vc, animated: true)
        }
    }
    func singleErrorTitleParsing(data:String,index:String){

        let vc = examReportRecordView()
        vc.errorQuestionList = data
        vc.index = Int(index)!
        self.isPused = true
        self.navigationController?.pushViewController(vc, animated: true)

    }

}
