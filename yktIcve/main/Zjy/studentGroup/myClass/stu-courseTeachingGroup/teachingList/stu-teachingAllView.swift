//
//  stu-teachingAllView.swift
//  云课堂2
//
//  Created by 志辉教育 on 2018/6/30.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import SwiftyJSON
class stu_teachingAllView: UIViewController,UITableViewDelegate,UITableViewDataSource {
    
    
    
    override func viewDidLoad() {
        super.viewDidLoad()
        self.title = "课堂教学"
        self.view.backgroundColor = UIColor.colorWithHex(hexColor: 0xfafafa)
        if !self.isHadenTop{
            self.setTopUI()
        }
        let item = UIBarButtonItem(title: "返回", style: .plain, target: self, action: nil)
        self.navigationItem.backBarButtonItem = item
        self.getallface(date: "", isRefresh: true)
        //        self.navigationController?.navigationBar.isTranslucent = false;
        // Do any additional setup after loading the view.
    }
    
    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }
    
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return self.List.count;
    }
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -> CGFloat {
        return 142
    }
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        
        
        let identifier = "CourseTeachsCell"
        self.tableView.register(UINib(nibName:"CourseTeachsCell", bundle:nil),
                                forCellReuseIdentifier:identifier)
        
        let cell:CourseTeachsCell = tableView.dequeueReusableCell(withIdentifier: identifier)
            as! CourseTeachsCell
        cell.selectionStyle = UITableViewCellSelectionStyle.none
        let json = self.List[indexPath.row]
        if self.isHadenTop{
           cell.ishaddenStucourseName = true
        }else{
           cell.ishaddenStucourseName = false
        }
        cell.setStujson(json: json)
        return cell
    }
    
    //跳转到活动
    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
            let json = self.List[indexPath.row]
            let vc = activityTableView()
            vc.openClassId = json["openClassId"].stringValue
            vc.courseOpenId = json["courseOpenId"].stringValue
            vc.activityId = json["Id"].stringValue
            vc.classState = json["state"].intValue
            self.navigationController?.pushViewController(vc, animated: true)
    }
    

    func setTopUI(){
        self.view.addSubview(top_View)
        self.top_View.addSubview(btn_Anyclass)
        self.top_View.addSubview(btn_Anycourse)
        self.top_View.snp.makeConstraints { (make) in
            make.width.equalTo(width)
            make.height.equalTo(40)
            make.centerX.equalTo(self.view.snp.centerX)
            make.top.equalTo(0)
        }
        self.btn_Anycourse.snp.makeConstraints { (make) in
            make.width.equalTo(width/2)
            make.height.equalTo(40)
            make.centerY.equalTo(self.top_View.snp.centerY)
            make.left.equalTo(0)
        }
        self.btn_Anycourse.addTarget(self, action: #selector(self.tap(_:)), for:.touchUpInside)
        self.btn_Anyclass.snp.makeConstraints { (make) in
            make.width.height.centerY.equalTo(self.btn_Anycourse)
            make.left.equalTo(self.btn_Anycourse.snp.right).offset(0)
        }
        self.btn_Anyclass.addTarget(self, action: #selector(self.tap(_:)), for:.touchUpInside)
    }
    func setUI(){
        
        if self.isHadenTop{
            self.tableView = UITableView.init(frame:  CGRect(x:0, y:0, width:self.view.bounds.width, height:self.view.bounds.height))
        }else{
            self.tableView = UITableView.init(frame:  CGRect(x:0, y:40, width:self.view.bounds.width, height:self.view.bounds.height - 40))
        }
        self.tableView.delegate = self;
        self.tableView.dataSource = self;
        // 设置分割线的样式为None.
        self.tableView.separatorStyle = UITableViewCellSeparatorStyle.none
        self.tableView.tableFooterView = UIView(frame:CGRect.zero)//除去多余的cell
        //下拉刷新相关设置,使用闭包Block
        self.tableView.mj_header = MJRefreshNormalHeader(refreshingBlock: {
            self.getallface(date: "", isRefresh: false)
        })
        
        self.view.addSubview(self.tableView)
    }
    //不限课程，班级
    @objc func tap(_ btn : UIButton){
        btn.isSelected = true;
        if(btn.tag == 4){
            self.getCourseList(isCourse: true)
        }else{
            self.getClassList(isCourse: false)
        }
    }
    
    
    
    lazy var openClassId :String = {
        return ""
    }()
    lazy var courseOpenId :String = {
        return ""
    }()
    lazy var OpenClassName :String = {
        return ""
    }()
    lazy var CourseName :String = {
        return ""
    }()
    
    var tableView :UITableView!
    lazy var List : JSON =  {
        return []
    }()
    lazy var courseList : JSON =  {
        return []
    }()
    lazy var classList : JSON =  {
        return []
    }()
    var isHadenTop:Bool = false
    let width = UIScreen.main.bounds.width
    lazy var top_View:UIView = {
        let view = UIView()
        view.backgroundColor = UIColor.white
        return view
    }()
    //不限课程
    lazy var btn_Anycourse:UIButton = {
        let btn = UIButton()
        btn.setTitle("全部课程 \u{e607}", for:.normal)
        btn.titleLabel?.font = UIFont.init(name: "iconfont", size: 14)
        btn.titleLabel?.textAlignment = .center
        btn.setTitleColor(UIColor.colorWithHex(hexColor: 0x646464), for:.normal)
        btn.setTitleColor(UIColor.bg, for:.selected)
        btn.tag = 4
        return btn
    }()
    
    //不限班级
    lazy var btn_Anyclass:UIButton = {
        let btn = UIButton()
        btn.setTitle("全部班级 \u{e607}", for:.normal)
        btn.titleLabel?.font = UIFont.init(name: "iconfont", size: 14)
        btn.titleLabel?.textAlignment = .center
        btn.setTitleColor(UIColor.colorWithHex(hexColor: 0x646464), for:.normal)
        btn.setTitleColor(UIColor.bg, for:.selected)
        btn.tag = 5
        return btn
    }()
    
}















