//
//  examinationdetailsView.swift
//  云课堂-职教云
//
//  Created by 志辉教育 on 2018/3/26.
//  Copyright © 2018年 zqy. All rights reserved.
//

import UIKit
import Alamofire
import SwiftyJSON
class examinationdetailsView: UIViewController,UITableViewDelegate,UITableViewDataSource {
    
    func numberOfSections(in tableView: UITableView) -> Int {
        return 1
    }
    
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -> CGFloat{
        return 45;
    }
    
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return list.count;
    }
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        //为了提供表格显示性能，已创建完成的单元需重复使用
        let identify:String = "SwiftCell"
        //同一形式的单元格重复使用，在声明时已注册
        let cell = tableView.dequeueReusableCell(withIdentifier: identify,
                                                 for: indexPath) as! examinationdetailsCell
        let json = JSON(self.list[indexPath.row]);

            cell.lab_Serialnumber.text = "\(indexPath.row + 1 )"
            cell.lab_Title.text = "\(json["title"])"
            cell.lab_submitTime.text = "\(json["dateCreated"])"
            cell.lab_useTime.text = "\(json["useTime"])"
        cell.lab_useTime.numberOfLines = 2
            cell.lab_weight.text = "\(json["weight"])"
            cell.lab_weightfen.text = "\(json["weightScore"])"
            if "\(json["getScore"])" == "---"{
                cell.lab_Score.text = "0"
            }
            else{
                cell.lab_Score.text = "\(json["getScore"])"
            }
        
        return cell
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        refreshItemData(isRefresh:true)
        
        
        // Do any additional setup after loading the view.
        
        self.view.backgroundColor = UIColor.white;
        // 打开横屏功能
//        appDelegate.allowRotation = false
//        let value = UIInterfaceOrientation.portrait.rawValue
//        (UIApplication.shared.delegate as! AppDelegate).allowRotation = false
//        UIDevice.current.setValue(value, forKey: "orientation")
    }
    
    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }
    func  setTableView(){
        
        //将浏览器视图全屏(在内容区域全屏,不占用顶端时间条)
        var frame = CGRect(x:0, y:0, width:UIScreen.main.bounds.width,
                           height:UIScreen.main.bounds.height )
        if(UIDevice.current.model == "iPad"){
            frame = CGRect(x:0, y:0, width:UIScreen.main.bounds.width,
                           height:UIScreen.main.bounds.height  )
            
        }
        //创建表视图
        self.tableView = UITableView.init(frame:  CGRect(x:0, y:40, width:self.view.bounds.width, height:height - 75))
        
        self.tableView.delegate = self;
        self.tableView.dataSource = self;
        
        //        //创建一个重用的单元格
        self.tableView.register(examinationdetailsCell.self, forCellReuseIdentifier: "SwiftCell");
        //
        self.tableView.tableFooterView = UIView(frame:CGRect.zero)//除去多余的cell
        //
        if #available(iOS 9.0, *) {
            self.tableView.cellLayoutMarginsFollowReadableWidth = false
        } else {
            
        }
        self.view.addSubview(self.tableView);
        
    }
    /*
     // MARK: - Navigation
     
     // In a storyboard-based application, you will often want to do a little preparation before navigation
     override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
     // Get the new view controller using segue.destinationViewController.
     // Pass the selected object to the new view controller.
     }
     */
    
    func setUI(){
        self.view.addSubview(self.btn_View)
        
        self.btn_View.addSubview(lab_weightfen)
        self.btn_View.addSubview(lab_weight)
        self.btn_View.addSubview(lab_name)
        self.btn_View.addSubview(lab_score)
        self.btn_View.addSubview(lab_usetime)
        self.btn_View.addSubview(lab_submittime)
        self.btn_View.addSubview(lab_tittle)
        self.btn_View.snp.makeConstraints { (make) in
            make.width.equalTo(width)
            make.height.equalTo(45)
            make.top.equalTo(0)
            make.left.equalTo(0)
        }
        self.lab_name.snp.makeConstraints{ (make) in
            make.width.equalTo(width/7)
            make.height.equalTo(45)
            make.centerY.equalTo(self.btn_View.snp.centerY)
            make.left.equalTo(0)
        }
        
        self.lab_tittle.snp.makeConstraints{ (make) in
            make.width.height.centerY.equalTo(self.lab_name)
            make.left.equalTo(self.lab_name.snp.right).offset(0)
        }
        
        self.lab_submittime.snp.makeConstraints{ (make) in
            make.width.height.centerY.equalTo(self.lab_name)
            make.left.equalTo(self.lab_tittle.snp.right).offset(0)
        }
        
        self.lab_usetime.snp.makeConstraints{ (make) in
            make.width.height.centerY.equalTo(self.lab_name)
            make.left.equalTo(self.lab_submittime.snp.right).offset(0)
        }
        
        self.lab_weight.snp.makeConstraints{ (make) in
            make.width.height.centerY.equalTo(self.lab_name)
            make.left.equalTo(self.lab_usetime.snp.right).offset(0)
        }
        
        self.lab_weightfen.snp.makeConstraints{ (make) in
            make.width.height.centerY.equalTo(self.lab_name)
            make.left.equalTo(self.lab_weight.snp.right).offset(0)
        }
        
        self.lab_score.snp.makeConstraints{ (make) in
            make.width.height.centerY.equalTo(self.lab_name)
            make.left.equalTo(self.lab_weightfen.snp.right).offset(0)
        }
        
    }
    
    lazy var btn_View:UIView = {
        let view = UIView()
        view.backgroundColor = UIColor.colorWithHex(hexColor: 0xf2f2f2)
        return view
    }()
    //序号
    lazy var lab_name :UILabel = {
        let lab = UILabel()
        lab.textColor = UIColor.gray
        lab.font = UIFont.init(name: "iconfont", size: 14)
        lab.textAlignment = NSTextAlignment.center
        lab.text = "序号"
        return lab
    }()
    
    lazy var lab_tittle :UILabel = {
        let lab = UILabel()
        lab.textColor = UIColor.gray
        lab.font = UIFont.init(name: "iconfont", size: 14)
        lab.textAlignment = NSTextAlignment.center
        lab.text = "标题"
        return lab
    }()
    
    lazy var lab_submittime :UILabel = {
        let lab = UILabel()
        lab.textColor = UIColor.gray
        lab.font = UIFont.init(name: "iconfont", size: 14)
        lab.textAlignment = NSTextAlignment.center
        lab.text = "提交时间"
        return lab
    }()
    
    lazy var lab_usetime :UILabel = {
        let lab = UILabel()
        lab.textColor = UIColor.gray
        lab.font = UIFont.init(name: "iconfont", size: 14)
        lab.textAlignment = NSTextAlignment.center
        lab.text = "用时"
        return lab
    }()
    
    lazy var lab_weight :UILabel = {
        let lab = UILabel()
        lab.textColor = UIColor.gray
        lab.font = UIFont.init(name: "iconfont", size: 14)
        lab.textAlignment = NSTextAlignment.center
        lab.text = "权重"
        return lab
    }()
    
    lazy var lab_weightfen :UILabel = {
        let lab = UILabel()
        lab.textColor = UIColor.gray
        lab.font = UIFont.init(name: "iconfont", size: 14)
        lab.textAlignment = NSTextAlignment.center
        lab.text = "权重分"
        return lab
    }()
    //得分
    lazy var lab_score :UILabel = {
        let lab = UILabel()
        lab.textColor = UIColor.gray
        lab.font = UIFont.init(name: "iconfont", size: 14)
        lab.textAlignment = NSTextAlignment.center
        lab.text = "得分"
        return lab
    }()
    let appDelegate = UIApplication.shared.delegate as! AppDelegate
    var tableView :UITableView!
    let width = UIScreen.main.bounds.width;
    let height = UIScreen.main.bounds.height;
    var list :JSON = []
    lazy var openClassId :String = {return ""}()
    lazy var courseOpenId :String = {return ""}()
    lazy var stuId: String = {
        return UserDefaults.standard.value(forKey: "userId") as! String!
    }()
}
