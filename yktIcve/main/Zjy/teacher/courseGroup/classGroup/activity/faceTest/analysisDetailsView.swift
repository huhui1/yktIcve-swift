//
//  analysisDetailsView.swift
//  云课堂职教云
//
//  Created by cc on 2018/4/4.
//  Copyright © 2018年 jcjy. All rights reserved.
//

import UIKit
import SwiftyJSON

class analysisDetailsView: UIViewController,UITableViewDataSource,UITableViewDelegate {

    override func viewDidLoad() {
        super.viewDidLoad()
        self.title = "答题详情"
        self.view.backgroundColor = UIColor.white
        self.setUI()
        self.getData()
    }
    
    func setUI(){
        self.view.addSubview(self.headView)
        self.headView.snp.makeConstraints{ (make) in
            make.width.equalTo(width)
            make.height.equalTo(43)
            make.top.equalTo(0)
            make.left.equalTo(0)
        }
        self.headView.addSubview(self.lab_option)
        self.lab_option.snp.makeConstraints{ (make) in
            make.width.equalTo(width / 3)
            make.height.equalTo(40)
            make.top.equalTo(0)
            make.left.equalTo(0)
        }
        self.headView.addSubview(self.lab_total)
        self.lab_total.snp.makeConstraints{ (make) in
            make.width.equalTo(width / 3)
            make.height.equalTo(40)
            make.top.equalTo(0)
            make.left.equalTo(self.lab_option.snp.right)
        }
        self.headView.addSubview(self.lab_student)
        self.lab_student.snp.makeConstraints{ (make) in
            make.width.equalTo(width / 3)
            make.height.equalTo(40)
            make.top.equalTo(0)
            make.left.equalTo(self.lab_total.snp.right)
        }
        self.headView.addSubview(self.lab_line)
        self.lab_line.snp.makeConstraints{ (make) in
            make.width.equalTo(headView)
            make.height.equalTo(3)
            make.left.equalTo(0)
            make.top.equalTo(self.lab_option.snp.bottom)
        }
        
        self.setTableUI()
    }
    
    
    func setTableUI(){
        
         self.tableView = UITableView.init(frame: CGRect.init(x: 0, y: 43, width: width, height: height - 110))
         self.tableView.backgroundColor = UIColor.white
         self.tableView.register(analysisDetailsTableViewCell.self, forCellReuseIdentifier: "SwiftCell");
//        //除去多余的cell
         self.tableView.tableFooterView = UIView(frame:CGRect.zero)
         self.tableView.separatorInset = UIEdgeInsets.zero;
//         self.tableView.layoutMargins = UIEdgeInsets.zero;
        self.tableView.delegate = self;
        self.tableView.dataSource = self;
        // 设置 tabelView 行高,自动计算行高
        self.tableView.estimatedRowHeight = 10
        self.tableView.rowHeight = UITableViewAutomaticDimension
        self.view.addSubview(self.tableView)
    }
    
    
    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }
    
    //返回的行数
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        // #warning Incomplete implementation, return the number of rows
        return self.list.count
    }
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
         let cell:analysisDetailsTableViewCell = tableView.dequeueReusableCell(withIdentifier: "SwiftCell", for: indexPath) as! analysisDetailsTableViewCell
        
    
        let json = JSON(self.list[indexPath.row]);
        
        if(json["option"] < 0){
            cell.lab_option.text = "未答"
            cell.lab_option.textColor = UIColor.red
        }else{
            cell.lab_option.text = OptionArr[indexPath.row] as! String
        }
        cell.lab_student.numberOfLines = 0
        if(json["stuList"].stringValue.isEmpty){
            cell.lab_student.text = "  "
            cell.lab_total.text = "0"
        }else{
            cell.lab_student.text = json["stuList"].stringValue
            cell.lab_total.text =  String(json["stuList"].description.components(separatedBy: ",").count)
        }

        
        return cell
    }
    //头部
   fileprivate lazy var headView : UIView = {
       let view = UIView()
        view.backgroundColor = UIColor.white
        return view
    }()
    lazy var lab_option : UILabel = {
       let lab = UILabel()
        lab.font = UIFont.italicSystemFont(ofSize: 17)
        lab.text = "选项"
        lab.textColor = UIColor.black
        lab.backgroundColor = UIColor.white
        lab.textAlignment = .center
        return lab
    }()
    lazy var lab_total: UILabel = {
        let lab = UILabel()
        lab.font = UIFont.italicSystemFont(ofSize: 17)
        lab.text = "小计"
        lab.textColor = UIColor.black
        lab.backgroundColor = UIColor.white
        lab.textAlignment = .center
        return lab
    }()
    lazy var lab_student : UILabel = {
        let lab = UILabel()
        lab.font = UIFont.italicSystemFont(ofSize: 17)
        lab.text = "学生"
        lab.textColor = UIColor.black
        lab.backgroundColor = UIColor.white
        lab.textAlignment = .center
        return lab
    }()
    lazy var lab_line : UILabel = {
       let lab = UILabel()
        lab.backgroundColor = UIColor.colorWithHex(hexColor: 0xf1f1f1)
        return lab
    }()
    
    var tableView : UITableView!
    

    let width = UIScreen.main.bounds.width
    let height = UIScreen.main.bounds.height
    lazy var courseOpenId : String = {return ""}()
    lazy var activityId : String = {return ""}()
    lazy var classTestId : String = {return ""}()
    lazy var questionId : String = {return ""}()
    lazy var list : NSArray = []
    var OptionArr :  NSArray = ["A","B","C","D","E","F","G"]
}
