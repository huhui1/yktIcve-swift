//
//  StuAttendQuestinaireView.swift
//  云课堂职教云
//  问卷学生参与未参与
//  Created by 尤增强 on 2018/4/16.
//  Copyright © 2018年 jcjy. All rights reserved.
//

import UIKit
import SwiftyJSON
import Alamofire

class stuAttendQuestinaireView: UITableViewController{

    override func viewDidLoad() {
        super.viewDidLoad()
        self.view.backgroundColor = UIColor.white
        
        self.getData()
        //方法 FaceTeach_getQuestionnaireStuList
        //  courseOpenId: _this.courseOpenId,
       // activityId: _this.activityId,
       // questionnaireId: _this.questionnaireId
        // Do any additional setup after loading the view.
    }
    
    func setSlideMenu(){
        let titles = ["未参与(\(self.unQuestionnaireStuCount))","已参与(\(self.questionnaireStuCount))"]
        var arr:Array<UITableViewController> = [];
        let vc1 = stuUnAttendQuestinaireNumberTableView();
        let vc2 = stuAttendQuestinaireNumberTableView();
        
        vc1.activityId = self.activityId
        vc1.courseOpenId = self.courseOpenId
        vc1.questionnaireId = self.questionnaireId
    
        vc2.activityId = self.activityId
        vc2.courseOpenId = self.courseOpenId
        vc2.questionnaireId = self.questionnaireId
        
        arr.append(vc1)
        arr.append(vc2)
        slideMenu = SlideMenu(frame: CGRect(x:0,y:0,width:view.frame.width,height:40), titles:titles, childControllers:arr)
        slideMenu?.bodyFrame = CGRect.init(x: 0, y: 40, width: view.frame.width, height: view.frame.height - 44)
        slideMenu?.selectedColor = UIColor(red: 6/255, green: 163/255, blue: 121/255, alpha: 1);
        
        slideMenu?.isFixed = true;
        slideMenu?.indicatorStyle = .followText;
        slideMenu?.titleStyle = .transfrom;
        slideMenu?.line.isHidden = false;
        if(num == 1){
            slideMenu?.scrollToIndex(0)
        }else if(num == 2){
            slideMenu?.scrollToIndex(1)
        }
        view.addSubview(slideMenu!)
    }
    override func viewDidDisappear(_ animated: Bool) {
        
        navigationController?.interactivePopGestureRecognizer?.isEnabled = true
    }
    override func viewDidAppear(_ animated: Bool) {
        
        navigationController?.interactivePopGestureRecognizer?.isEnabled = false
    }
    
    func getData(){
//        ZKProgressHUD.setAnimationStyle(.chrysanthemum)
//        ZKProgressHUD.show()
        XLBallLoading.show(in: self.view)
        let dict = ["courseOpenId":self.courseOpenId,
                    "activityId":self.activityId,
                    "questionnaireId":self.questionnaireId] as [String:Any]
         Alamofire.request(appAPI.FaceTeach_getQuestionnaireStuList, method: .post,parameters: dict, encoding: URLEncoding.default).responseJSON { response in
            if let value = response.result.value {
                let json = JSON(value)
                if json["code"] == 1{
//                    ZKProgressHUD.hide()
                    self.questionnaireStuCount = json["questionnaireStuCount"].intValue;
                    self.unQuestionnaireStuCount = json["unQuestionnaireStuCount"].intValue;
                    self.setSlideMenu()
                }else{
                    ZKProgressHUD.showError(json["msg"].stringValue);
                }
                XLBallLoading.hide(in: self.view)
            }else{
                XLBallLoading.hide(in: self.view)
                ZKProgressHUD.showError("网络环境异常请稍后再试！");
            }
         }
    }
    

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }


    
    let width = UIScreen.main.bounds.width
    let height = UIScreen.main.bounds.height
    lazy var list : NSArray = []
    var slideMenu:SlideMenu?
    
    lazy var  courseOpenId:String = {
        return ""
    }()

    lazy var  activityId:String = {
        return ""
    }()

    lazy var  questionnaireId:String = {
        return ""
    }()
    lazy var questionnaireStuCount: Int = {
        return 0
    }()
    lazy var unQuestionnaireStuCount: Int = {
        return 0
    }()
    lazy var num : Int = {return 0}()

    /*
    // MARK: - Navigation

    // In a storyboard-based application, you will often want to do a little preparation before navigation
    override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
        // Get the new view controller using segue.destinationViewController.
        // Pass the selected object to the new view controller.
    }
    */

}
