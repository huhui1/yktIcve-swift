//
//  questionnaireAnalysisDetailsViewController.swift
//  云课堂职教云
//
//  Created by 尤增强 on 2018/4/16.
//  Copyright © 2018年 jcjy. All rights reserved.
//

import UIKit
import Alamofire
import SwiftyJSON

extension questionnaireAnalysisDetailsView{

    //获取数据
    func getData(){

//        activityId: _this.activityId,
//        questionnaireId: _this.questionnaireId,
//        questionId: questionId
        let dict = ["activityId": self.activityId,
                    "questionnaireId":self.questionnaireId,
                    "questionId":self.questionId]
        //        ZKProgressHUD.setAnimationStyle(.chrysanthemum);
//
//        ZKProgressHUD.show();
        XLBallLoading.show(in: self.view)
        Alamofire.request(appAPI.FaceTeach_questionnaireQuestionStatis, method: .post, parameters: dict, encoding: URLEncoding.default).responseJSON { response in

            if let value = response.result.value {
                let json = JSON(value)
                if json["code"] == 1{

//                    ZKProgressHUD.hide()
                self.theWebView.evaluateJavaScript("questionSurwayDetail.get(\(json));",
                        completionHandler: nil)

                }else{
                    ZKProgressHUD.showError(json["msg"].stringValue);
                }
                XLBallLoading.hide(in: self.view)
            }else{
                ZKProgressHUD.showError("网络环境异常请稍后再试！");
                XLBallLoading.hide(in: self.view)
            }
        }


    }

    @objc func switchQuestion(_ btn :UIButton){
        let tag = btn.tag
        if(tag == 1){
            if(self.index == 0){
                ZKProgressHUD.showMessage("已经是第一题")
            }else{
                self.index  -= 1;
                self.questionId = self.questionlist[self.index]["questionId"].stringValue;
                self.getData()
            }

        }else {
            if(self.index == self.total - 1){
                ZKProgressHUD.showMessage("已经是最后一题")
            }else{
                self.index  += 1;
                self.questionId = self.questionlist[self.index]["questionId"].stringValue;
                self.getData()
            }
        }
        self.title = "(\(self.index + 1)  / \(self.total))"
    }

}
