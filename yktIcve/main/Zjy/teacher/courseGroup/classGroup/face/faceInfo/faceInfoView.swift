//
//  faceInfoView.swift
//  云课堂2
//
//  Created by 志辉教育 on 2018/7/10.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit

class faceInfoView: UIViewController {

    var activity : teachActivity?

    var slideMenu:SlideMenu?
    
    
    let statebtn = UIButton(type: .custom);
    
    let  state_color = [0x80c53d,0xd0de37,0xfa1923,0x80c53d],
    lab_stateicon = ["\u{e6da}","\u{e6da}","\u{e674}","\u{e69a}"],
    width = UIScreen.main.bounds.width,
    height = UIScreen.main.bounds.height;


    override func viewDidLoad() {
        super.viewDidLoad()

        self.activity = teachActivity.init(name: "")
        self.title = "课堂教学"
        self.activity?.addObserver(self, forKeyPath: "name", options: [.new, .old], context: nil)
        self.setUI();
        let item = UIBarButtonItem(title: "返回", style: .plain, target: self, action: nil)
        self.navigationItem.backBarButtonItem = item
        self.navigationController?.navigationBar.tintColor = UIColor.white
        self.view.backgroundColor = UIColor.init(red: 237/255, green: 237/255, blue: 237/255, alpha: 1);
        // Do any additional setup after loading the view.
       
    }
    
    func setUI(){
        let titles = ["课前","课中","课后"]
        var arr:Array<UIViewController> = [];
        let vc1 = beforeClassView();
        let vc2 = LessonView();
        let vc3 = afterClassView();
        
        arr.append(vc1)
        arr.append(vc2)
        arr.append(vc3)
        vc1.activity = self.activity
        vc2.activity = self.activity
        vc3.activity = self.activity
        slideMenu = SlideMenu(frame: CGRect(x:0,y:4,width:width,height:40), titles:titles, childControllers:arr)
        slideMenu?.bodyFrame = CGRect.init(x: 0, y: 44, width: width, height: height - 40)
        slideMenu?.selectedColor = UIColor.bg;
        
        slideMenu?.isFixed = true;
        slideMenu?.indicatorStyle = .followText;
        slideMenu?.titleStyle = .transfrom;
        slideMenu?.line.isHidden = false;
        slideMenu?.scrollToIndex(0)
        view.addSubview(slideMenu!)
    }
    
    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }
    
    
    override func viewDidDisappear(_ animated: Bool) {
        navigationController?.interactivePopGestureRecognizer?.isEnabled  = true;
    }
    
    override func viewDidAppear(_ animated: Bool) {
        navigationController?.interactivePopGestureRecognizer?.isEnabled  = false;
    }

    //添加监听后,使用完必须移除监听(一个add 对应一个 remove)
    deinit {
        self.activity?.removeObserver(self, forKeyPath: "name", context: nil)
    }

    override func observeValue(forKeyPath keyPath: String?, of object: Any?, change: [NSKeyValueChangeKey : Any]?, context: UnsafeMutableRawPointer?) {
        if keyPath == "name" {
            let type =  change![NSKeyValueChangeKey.newKey] as? String
            self.pushVCByType(type: type!, classState: (self.activity?.classState)!)
        }
    }

    lazy  var courseOpenId = ""
    lazy  var openClassIds = ""
    lazy  var activityId = ""
    lazy  var faceTimeStatus = 0
   
    /*
     // MARK: - Navigation
     
     // In a storyboard-based application, you will often want to do a little preparation before navigation
     override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
     // Get the new view controller using segue.destinationViewController.
     // Pass the selected object to the new view controller.
     }
     */
    
}

