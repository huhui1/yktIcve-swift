//
//  unifiedCorrectingView.swift
//  云课堂2
//
//  Created by 尤增强 on 2018/7/7.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import Alamofire
import SwiftyJSON
class unifiedCorrectingView: UIViewController,UITextFieldDelegate{
    @IBOutlet var Btn_cancel: UIButton!
    @IBOutlet var Btn_determine: UIButton!
    @IBOutlet var textFiled: UITextField!
    override func viewDidLoad() {
        super.viewDidLoad()
        self.textFiled.delegate = self
        self.textFiled.keyboardType = .numberPad
        // Do any additional setup after loading the view.
        
        
    }

    @IBAction func Btn_determine(_ sender: Any) {
        
        let score = self.textFiled.text!
        if score.isEmpty{
            ZKProgressHUD.showMessage("请输入分数");
            return
        }else{
            let s = Int(score)
            if s! < 0 || s! > 100{
                ZKProgressHUD.showMessage("请输入0到100之间的分数");
                return
            }
        }
        
        self.getFileGroupHKPreview()
    }
    
 
    @IBAction func Btn_cancel(_ sender: Any) {
  NotificationCenter.default.post(name:NSNotification.Name("ZjycorrectingScore"), object: "1");
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }
    lazy var courseOpenId:String = ""
    lazy var openClassId:String = ""
    lazy var homeworkTermTimeId:String = ""
    lazy var openClassGroupId:String = ""
    lazy var groupTaskGroupId:String = ""
    lazy var hkTimeId:String = ""
    lazy var homeWorkId:String = ""
    lazy var homeworkStuId:String = ""
    lazy var stuId:String = ""
}
extension unifiedCorrectingView {
    //统一打分小组作业
    func getFileGroupHKPreview(){
        let dict = ["openClassId":self.openClassId,
                    "openClassGroupId":self.openClassGroupId,
                    "groupTaskGroupId":self.groupTaskGroupId,
                    "homeworkId":self.homeWorkId,
                    "hkTimeId":self.hkTimeId,
                    "getScore":self.textFiled.text!] as [String : Any]
        XLBallLoading.show(in: self.view)
        Alamofire.request(appAPI.Homework_setAllStuScoreByGroupHK, method: .post, parameters: dict, encoding: URLEncoding.default).responseJSON { response in
            if let value = response.result.value {
                let json = JSON(value)
                if json["code"] == 1{
                     ZKProgressHUD.showMessage("批改成功")
                    NotificationCenter.default.post(name:NSNotification.Name("ZjycorrectingScore"), object: "2");
                }else{
                    ZKProgressHUD.showMessage(json["msg"].string)
                }
                XLBallLoading.hide(in: self.view)
            }else{
                ZKProgressHUD.showMessage("网络异常请稍后再试！");
                XLBallLoading.hide(in: self.view)
            }
        }
    }

}
