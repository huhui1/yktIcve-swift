//
//  personalStatisticsViewController.swift
//  云课堂2
//
//  Created by cc on 2018/8/2.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import WebKit

class personalStatisticsViewController: UIViewController,WKNavigationDelegate {
    //隐藏状态栏
    override var prefersStatusBarHidden: Bool {
        return true
    }
    
    
    
    override func viewDidLoad() {
        super.viewDidLoad()
        self.view.backgroundColor = UIColor.colorWithHex(hexColor: 0x01243c)
        self.webView.backgroundColor = UIColor.colorWithHex(hexColor: 0x01243c)
        self.setWebView()
        // Do any additional setup after loading the view.
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }

    
    func setWebView(){

        let url = NSURL(string:  appAPI.personalStatistics + Account.defaultAccount.id!)

        let request = URLRequest(url:url! as URL);
        webView.load(request as URLRequest)
        self.view.addSubview(self.webView)
        webView.snp.makeConstraints{ (make) in
            make.width.equalTo(UIScreen.main.bounds.width)
            make.height.equalTo(UIScreen.main.bounds.height)
            make.left.equalTo(0)
            make.top.equalTo(0)
        }
        self.webView.navigationDelegate = self
        
        self.webView.addSubview(self.headView)
        self.headView.addSubview(self.btn_back)
        self.headView.addSubview(self.btn_share)
        self.headView.snp.makeConstraints { (make) in
            make.width.equalTo(width)
            make.height.equalTo(50)
            make.left.equalTo(0)
            make.top.equalTo(0)
        }
        self.btn_back.snp.makeConstraints { (make) in
            make.width.height.equalTo(40)
            make.left.equalTo(self.headView.snp.left).offset(10)
            make.centerY.equalTo(self.headView.snp.centerY)
        }
        self.btn_back.addTarget(self, action: #selector(self.setback), for: .touchUpInside)

        self.btn_share.snp.makeConstraints { (make) in
            make.width.height.equalTo(40)
            make.right.equalTo(self.headView.snp.right).offset(-15)
            make.centerY.equalTo(self.headView.snp.centerY)
        }

        self.btn_share.addTarget(self, action: #selector(self.setShare), for: .touchUpInside)
        
        self.btn_back.isHidden = true
        self.btn_share.isHidden = true
        
       
    }
    //自定义返回
    @objc func setback(){
        self.presentingViewController?.dismiss(animated: true, completion: nil);
    }
    //分享
    @objc func setShare(){
        let previwe = shareCanopyViewController()
        previwe.IsStatistics = true
        previwe.view.backgroundColor = UIColor(red: 0, green: 0, blue: 0, alpha: 0);
        self.present(previwe, animated:true, completion:nil)
    }
    func webView(_ webView: WKWebView, didStartProvisionalNavigation navigation: WKNavigation!) {
        self.webView.addSubview(self.ladingView)
        self.ladingView.snp.makeConstraints { (make) in
            make.width.height.equalTo(5)
            make.center.equalTo(self.webView.snp.center)
        }
        XLBallLoading.show(in:self.ladingView)
    }
    
    //加载结束
    func webView(_ webView: WKWebView, didFinish navigation: WKNavigation!) {
        XLBallLoading.hide(in: self.ladingView)
        self.ladingView.isHidden = true
        self.btn_back.isHidden = false
        self.btn_share.isHidden = false
    }
    
    let width = UIScreen.main.bounds.width
    let height = UIScreen.main.bounds.height
    

    lazy var headView : UIView = {
        let view = UIView()
        return view
    }()
    lazy var btn_back : UIButton = {
        let btn = UIButton()
        btn.setTitle("\u{e703}", for: .normal)
        btn.titleLabel?.font = UIFont.init(name: "iconfont", size: 23)
        btn.setTitleColor(UIColor.colorWithHex(hexColor: 0x9ccbf9), for: .normal)
        return btn
    }()
    lazy var btn_share : UIButton = {
        let btn = UIButton()
        btn.setTitle("\u{e61b}", for: .normal)
        btn.titleLabel?.font = UIFont.init(name: "iconfont", size: 25)
        btn.setTitleColor(UIColor.colorWithHex(hexColor: 0x9ccbf9), for: .normal)
        return btn
    }()
    
    lazy var webView : WKWebView = {
        let web = WKWebView()
        return web
    }()
    
    lazy var linkStr :String = {
        return ""
    }()
    fileprivate  lazy var ladingView :UIView = {
        let view = UIView()
        return view
    }()
}
