//
//  MineInfoDetailsView.swift
//  云课堂2
//
//  Created by cc on 2018/7/18.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import SwiftyJSON
import Alamofire

class MineInfoDetailsView: UIViewController {

    override func viewDidLoad() {
        super.viewDidLoad()
        self.view.backgroundColor = UIColor.white
        self.setUI()
        self.lookNews()
        // Do any additional setup after loading the view.
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }
    func setUI(){
        if self.UserType == "1"{
            if self.NewsType == 1{
                Newstitle = "新的作业"
            }else{
                Newstitle = "新的考试"
            }
        }else{
            if self.NewsType == 1{
                Newstitle = "收到一个学生作业"
            }else{
                Newstitle = "收到一个学生作业"
            }
        }
        self.view.addSubview(self.lab_title)
        self.view.addSubview(self.lab_time)
        self.view.addSubview(self.lab_content)
        self.lab_title.snp.makeConstraints { (make) in
            make.width.equalTo(width)
            make.height.equalTo(20)
            make.left.equalTo(0)
            make.top.equalTo(20)
        }
        self.lab_title.text = self.Newstitle
        self.lab_time.snp.makeConstraints { (make) in
            make.width.equalTo(width)
            make.height.equalTo(20)
            make.left.equalTo(0)
            make.top.equalTo(self.lab_title.snp.bottom).offset(15)
        }
        self.lab_time.text = self.time
        self.lab_content.snp.makeConstraints { (make) in
            make.width.equalTo(width)
            make.left.equalTo(0)
            make.top.equalTo(self.lab_time.snp.bottom).offset(10)
        }
        //富文本
        let paraph = NSMutableParagraphStyle()
        paraph.lineSpacing  = 5
        paraph.headIndent = 20
        paraph.firstLineHeadIndent = 30
        let attributes = [NSAttributedStringKey.paragraphStyle: paraph]
        self.lab_content.attributedText = NSAttributedString(string:self.content,attributes:attributes)
        
    }
    let width = UIScreen.main.bounds.width

    lazy var lab_title : UILabel = {
        let lab = UILabel()
        lab.font = UIFont.init(name: "Helvetica-Light", size: 15)
        lab.textColor = UIColor.black
        lab.backgroundColor = UIColor.white
        lab.textAlignment = .center
        return lab
    }()
    lazy var lab_time : UILabel = {
        let lab = UILabel()
        lab.font = UIFont.init(name: "Helvetica-Light", size: 13)
        lab.textColor = UIColor.gray
        lab.backgroundColor = UIColor.white
        lab.textAlignment = .center
        return lab
    }()
    lazy var lab_content : UILabel = {
        let lab = UILabel()
        lab.font = UIFont.init(name: "Helvetica-Light", size: 12)
        lab.textColor = UIColor.gray
        lab.backgroundColor = UIColor.white
        lab.numberOfLines = 0
        lab.sizeToFit()
        return lab
    }()
    lazy var Newstitle:String = ""
    lazy var time:String = ""
    lazy var content:String = ""
    lazy var Id:String = ""
    var UserType:String = ""
    var NewsType:Int = 0
    var Newsmodel : NewsModel?
    var lookNewsListClosure :(() ->Void)?
}

extension MineInfoDetailsView{
    func lookNews(){
        let dict = ["Id":self.Id]
        XLBallLoading.show(in: self.view)
        Alamofire.request(appAPI.News_setNewsIsReadById, method: .post, parameters: dict).responseJSON { response in
            if let value = response.result.value {
                let json = JSON(value)
                if(json["code"] == 1){
                    self.Newsmodel?.IsRead = 1
                    self.lookNewsListClosure!()
                }else{
                    ZKProgressHUD.showMessage(json["msg"].stringValue)
                }
                XLBallLoading.hide(in: self.view)
            }else{
                ZKProgressHUD.showMessage("网络开小差了")
                XLBallLoading.hide(in: self.view)
            }
        }
    }
}
