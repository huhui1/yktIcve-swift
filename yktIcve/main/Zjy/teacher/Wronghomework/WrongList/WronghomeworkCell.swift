//
//  WronghomeworkCell.swift
//  云课堂2
//
//  Created by 志辉教育 on 2018/6/26.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import SwiftyJSON
@objc protocol WronghomeworkCellDelegate{
    //展开
    @objc optional func action_unfold( index:Int) -> ()
}

class WronghomeworkCell: UITableViewCell {
    var delegate:WronghomeworkCellDelegate!
    let width = UIScreen.main.bounds.width
    @IBOutlet weak var answerNumber: UILabel!
    @IBOutlet weak var knowledge: UILabel!
    @IBOutlet weak var bgview: UIView!
    @IBOutlet weak var btn: UIButton!
    @IBOutlet weak var title: UILabel!
    override func awakeFromNib() {
        super.awakeFromNib()
        // Initialization code
        
        self.answerNumber.isHidden = true
        self.knowledge.isHidden = true
        self.btn.isSelected = false
        //画线
        let line = common.share.drawline(lab: knowledge, width: width - 125)
        knowledge.layer.addSublayer(line)
        self.btn.titleLabel?.font = UIFont.init(name: "iconfont", size: 14)

    }
   

    override func setSelected(_ selected: Bool, animated: Bool) {
        super.setSelected(selected, animated: animated)

        // Configure the view for the selected state
    }

    func setmodel(model:Wronghomeworkmodel){
        if model.isopencell{
            self.answerNumber.isHidden = false
            self.knowledge.isHidden = false
            btn.setTitle("\u{e604}", for: .normal)
        }else{
            self.answerNumber.isHidden = true
            self.knowledge.isHidden = true
            btn.setTitle("\u{e607}", for: .normal)
        }
        self.title.text = self.removeHTML(htmlString:model.questionTitle)
        self.knowledge.attributedText =  common.share.setAttributeString(str:"知识点 :\(model.knowledgeTitle)", color:  UIColor.colorWithHex(hexColor: 0x27BE71), fontSize: 14, range:NSMakeRange(0,3))
        self.answerNumber.attributedText =  common.share.setAttributeString(str:"答题次数 :\(model.wrongCount)", color: UIColor.colorWithHex(hexColor: 0x27BE71), fontSize: 14, range:NSMakeRange(0,4))
    }

    override func layoutSubviews() {
        let shadowPath = UIBezierPath(roundedRect: bounds, cornerRadius: 0.6)
        self.bgview.layer.masksToBounds = false
        self.bgview.layer.cornerRadius = 6
        self.bgview.layer.shadowColor = UIColor.white.cgColor
        self.bgview.layer.shadowOffset = CGSize.zero // CGSize(width: shadowOffsetWidth, height: shadowOffsetHeight);
        self.bgview.layer.shadowOpacity = 0.11
        self.bgview.layer.shadowPath = shadowPath.cgPath
        self.bgview.layer.borderColor = UIColor.colorWithHex(hexColor: 0x32bd73).cgColor
        self.bgview.layer.borderWidth = 0.08
        self.backgroundColor = UIColor.colorWithHex(hexColor: 0xfafafa)
    }
    func removeHTML(htmlString : String)->String{
        return htmlString.replacingOccurrences(of: "<[^>]+>|&nbsp", with: "", options: .regularExpression, range: nil)
    }

    @IBAction func btn_unfold(_ sender: UIButton) {

        self.delegate.action_unfold!(index: sender.tag)
        
    }
    
    
    
}
