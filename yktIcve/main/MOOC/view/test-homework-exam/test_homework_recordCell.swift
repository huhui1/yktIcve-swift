//
//  test_homework_recordCell.swift
//  云课堂2
//
//  Created by 尤增强 on 2018/6/11.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import SwiftyJSON

@objc protocol test_homework_recordCellDelegate : NSObjectProtocol  {
    @objc optional func btn_action(index:Int,type:Int) -> ()
    
}


class test_homework_recordCell: UITableViewCell {

    @IBOutlet weak var lab_sendTime: UILabel!
    @IBOutlet weak var lab_index: UILabel!
    @IBOutlet weak var lab_useTime: UILabel!
    @IBOutlet weak var lab_state: UILabel!
    @IBOutlet weak var lab_socre: UILabel!
    @IBOutlet weak var btn_done: UIButton!
    var _index = 0
    var deletegate :test_homework_recordCellDelegate!
    override func awakeFromNib() {
        super.awakeFromNib()
      
        // Initialization code
    }

    override func layoutSubviews() {
        super.layoutSubviews()
        self.lab_index.backgroundColor = UIColor.bg
        self.lab_index.layer.masksToBounds = true
        self.lab_index.layer.cornerRadius = 2
        self.btn_done.backgroundColor = UIColor.bg
        self.btn_done.layer.masksToBounds = true
        self.btn_done.layer.cornerRadius = 2
    }
    override func setSelected(_ selected: Bool, animated: Bool) {
        super.setSelected(selected, animated: animated)

        // Configure the view for the selected state
    }

    func setDataByJson(data:JSON,index:Int){
        //state 作答状态 0.初始数据. 1.表示已交未批[主观题],2.已批,3.退回  4.草稿状态
        self._index = index
        self.lab_index.text = "\(index + 1)"
      
        if data["state"].intValue == 2{
            self.lab_socre.text = "得分:" + data["getScore"].stringValue
        }else{
            self.lab_socre.text = "得分: ---" 
        }
       
//        self.lab_useTime.text = "用时:" + data["useTime"].stringValue + "秒"
        self.lab_useTime.text = "用时:" + data["strUseTime"].stringValue
        self.lab_sendTime.text = "提交时间:" + data["dateCreated"].stringValue
        if data["state"].intValue == 3{
            self.btn_done.isHidden = true
        }else{
            self.btn_done.isHidden = false
        }
        self.lab_state.text = "状态:" +  state(s:data["state"].intValue) //  作答状态 0.初始数据. 1.表示已交未批[主观题],2.已批,3.退回  4.草稿状态

    }

    @IBAction func btn_action(_ sender: UIButton) {
        self.deletegate?.btn_action!(index: self._index, type: sender.tag)
    }

    //状态转化
    func state(s:Int)->String{

        switch s {
        case 1:
            self.btn_done.setTitle("查看", for: .normal)
            self.btn_done.tag = 1
           
           return "未批"
        case 2:
            self.btn_done.setTitle("查看", for: .normal)
            self.btn_done.tag = 1
            return "已批"
        case 3:
            self.btn_done.setTitle("查看", for: .normal)
            self.btn_done.tag = 1
            return "退回"
        case 4:
            self.btn_done.setTitle("续做", for: .normal)
            self.btn_done.tag = 2
            return "草稿"
        default:
            return ""
        }

    }
}
