//
//  courseware_tuWenViewController.swift
//  云课堂2
//
//  Created by 尤增强 on 2018/7/2.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import Alamofire
import SwiftyJSON

extension MoocCourseware_tuWenView{

    //获取图文信息
    func getTuwenData(){
            let dict = ["courseOpenId":self.courseOpenId,
                        "cellId":self.cellId,
                        "userId":Account.defaultAccount.id!] as [String : Any]
            XLBallLoading.show(in: self.view)
            Alamofire.request(MOOCAPI.Mooc_coursestudy_viewDirectory, method: .post, parameters: dict, encoding: URLEncoding.default).responseJSON { response in
                if let value = response.result.value {
                    let json = JSON(value)
                    XLBallLoading.hide(in: self.view)
                    if json["code"] == 1{
                         self.setHeadUI(json:json)
                    }else{
                        //ZKProgressHUD.showError(json["msg"].stringValue);
                    }
                }else{
                    XLBallLoading.hide(in: self.view)
                    ZKProgressHUD.showMessage("网络环境异常请稍后再试！")
                }
            }
        }
    


    //保存学习日志
   func savePlayLog(){
        if(!self.isStu){return }
        let dict = ["courseOpenId":self.courseOpenId,
                    "cellId":self.cellId,
                    "auvideoLength":"0",
                    "videoTimeTotalLong":"0",
                    "userId":Account.defaultAccount.id!] as [String : Any]
        Alamofire.request(MOOCAPI.coursestudy_statStuProcessCellLogAndTimeLong, method: .post, parameters: dict, encoding: URLEncoding.default).responseJSON { response in
            if let value = response.result.value {
                let json = JSON(value)
                if json["code"] == 1{
                    if json["isStudy"].boolValue{
                        //已学习
                        self.MOOCCourseKJModel?.cellRefresh = "cellRefresh"
                    }
                }else{
                    //ZKProgressHUD.showError(json["msg"].stringValue);
                }
            }else{
                ZKProgressHUD.showMessage("网络环境异常请稍后再试！")
            }
        }
    }



}
