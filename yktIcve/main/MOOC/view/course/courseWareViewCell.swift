//
//  courseWareViewCell.swift
//  云课堂2
//
//  Created by 尤增强 on 2018/5/29.
//  Copyright © 2018年 zqyou. All rights reserved.
//

import UIKit
import SwiftyJSON

@objc protocol courseWareViewCellDelegate{

    @objc optional func backId(id:String) -> ()
}

class courseWareViewCell: UITableViewCell {

    @IBOutlet var cellTypeHeight: NSLayoutConstraint!
    
    @IBOutlet var cellTypeWidth: NSLayoutConstraint!
    @IBOutlet weak var btn_sel: UIButton!
    @IBOutlet weak var lab_left: NSLayoutConstraint!
    @IBOutlet weak var cellTitle: UILabel!
    
    @IBOutlet weak var cellType: UILabel!
    var zjyModel :zjycourseTopic?
    @IBOutlet weak var titleConstraints: NSLayoutConstraint!
    var courseWareViewDelegate:courseWareViewCellDelegate?
    override func awakeFromNib() {
        super.awakeFromNib()
        // Initialization code
    }


    /// 课件选择
    ///
    /// - Parameter sender: <#sender description#>
    @IBAction func sel_action(_ sender: UIButton) {
        
        sender.isSelected =  !sender.isSelected
        self.courseWareViewDelegate?.backId!(id: (zjyModel?.id)!)
    }

    func cellDidSel(){
        self.btn_sel.isSelected =  !self.btn_sel.isSelected

        self.courseWareViewDelegate?.backId!(id: (zjyModel?.id)!)
    }
    //字体图标
    func shezhiSelected(str:String, colorStr:Int64) -> NSAttributedString{
        let attributeString = NSMutableAttributedString(string:str)
        attributeString.addAttribute(NSAttributedStringKey.foregroundColor, value: UIColor.bg,
                                     range: NSMakeRange(0,1))
        attributeString.addAttribute(NSAttributedStringKey.backgroundColor, value: UIColor.colorWithHex(hexColor: colorStr), range: NSMakeRange(0,1))
        attributeString.addAttribute(NSAttributedStringKey.font, value: UIFont.init(name: "iconfont", size: 26)!, range: NSMakeRange(0,1))
        return attributeString
    }
    
    override func layoutSubviews() {
        super.layoutSubviews()
        self.cellType.layer.masksToBounds = true
        self.cellType.layer.cornerRadius = 4
        self.cellType.layer.borderWidth = 1
        self.cellType.layer.borderColor = UIColor.bg.cgColor
        self.btn_sel.layer.masksToBounds = true
        self.btn_sel.layer.cornerRadius = 15
        self.btn_sel.setTitle("\u{e6f5}", for: .normal)
        self.btn_sel.setAttributedTitle(shezhiSelected(str: "\u{e6dc}", colorStr: 0xFFFFFF), for: .selected)
        self.btn_sel.setTitleColor(UIColor.bg, for: .normal)
        self.btn_sel.titleLabel?.font = UIFont.init(name: "iconfont", size: 26)
    }

    //MOOC 课件使用
    func setModel(model:courseTopic){
     
        if(model.isStudyFinish && !model.isteacher){
            self.cellType.textColor = UIColor.white
            self.cellType.backgroundColor = UIColor.bg
        }else{
            self.cellType.textColor = UIColor.bg
            self.cellType.backgroundColor = UIColor.white
        }
        self.cellTitle.text = model.title
        self.cellType.text = model.categoryName

        if(model.cellType == 4){
            self.cellTypeWidth.constant = 2
            self.cellTypeHeight.constant = 20
        }else{
            self.cellTypeWidth.constant = 46
            self.cellTypeHeight.constant = 30
        }
        self.selectionStyle = .none
    }

    //ZJY 课件使用
    func setZJYModel(model:zjycourseTopic,isstu:Bool){
        
        if(model.isStudyFinish && isstu){
                self.cellType.textColor = UIColor.white
                self.cellType.backgroundColor = UIColor.bg
            }else{
                self.cellType.textColor = UIColor.bg
        }
        self.cellTitle.text = model.title
        self.cellType.text = model.categoryName

        if(model.cellType == 4){
            self.cellTypeWidth.constant = 2
            self.cellTypeHeight.constant = 20
        }else{
            self.cellTypeWidth.constant = 46
            self.cellTypeHeight.constant = 30
        }
        self.selectionStyle = .none
    }

    //MOOC 大纲使用
    func setJSON(data:JSON){

        self.cellType.textColor = UIColor.bg

        self.cellTitle.text = data["Title"].stringValue.replacingOccurrences(of: "&nbsp;", with: "")
        self.cellType.text = data["ResourceType"].stringValue
        self.selectionStyle = .none
    }
    //Zyk 课件使用
    func setZykModel(model:ZykcourseTopic){
        if(model.isStudyFinish){
            self.cellType.textColor = UIColor.white
            self.cellType.backgroundColor = UIColor.bg
        }else{
            self.cellType.textColor = UIColor.bg
        }
        self.cellTitle.text = model.title
        self.cellType.text = model.categoryName
       
        if model.categoryName.isEmpty{
            switch model.cellType {
            case 1:
                self.cellType.text = "视频"
            case 2:
                self.cellType.text = "随堂检测"
            case 3:
                self.cellType.text = "讨论"
            case 4:
                self.cellType.text = "文档"
            case 5:
                self.cellType.text = "富文本"
            case 6:
                self.cellType.text = "知识点"
            default:
                self.cellType.text = "知识点"
            }
            
        }
        if model.ishaddentype{
            self.cellType.isHidden = true
            self.titleConstraints.constant = -44
        }
        self.selectionStyle = .none
    }

    //ZJY 选择课件使用
    func setSelZJYModel(model:zjycourseTopic){
        self.zjyModel = model
        self.lab_left.constant = 50
        self.btn_sel.isHidden = false

        self.cellType.textColor = UIColor.bg
  
        self.cellTitle.text = model.title
        self.cellType.text = model.categoryName

        if(model.cellType == 4){
            self.cellType.isHidden = true
            self.btn_sel.isHidden = true
            self.titleConstraints.constant = -44
        }
        self.btn_sel.isSelected = model.isChecked
        self.selectionStyle = .none
    }
    override func setSelected(_ selected: Bool, animated: Bool) {
        super.setSelected(selected, animated: animated)

        // Configure the view for the selected state
    }
    
}
